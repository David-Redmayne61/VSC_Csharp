@{
    ViewData["Title"] = "Import Data";
}

<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary">Import Data</h2>
        <a asp-controller="Home" asp-action="Index" class="btn btn-primary">
            <i class="fas fa-home"></i> Return to Home
        </a>
    </div>

    @if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @ViewBag.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    @if (!string.IsNullOrEmpty(ViewBag.SuccessMessage))
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @ViewBag.SuccessMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="card shadow">
        <div class="card-body">
            <form asp-action="ImportExcel" method="post" enctype="multipart/form-data">
                <div class="mb-3">
                    <label class="form-label">Select Excel File</label>
                    <input type="file" class="form-control" name="file" accept=".xlsx" required>
                    <div class="form-text">Only .xlsx files are supported</div>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-file-import"></i> Import Data
                </button>
            </form>
        </div>
    </div>

    <div class="card shadow mt-4">
        <div class="card-body">
            <h5 class="card-title">Import Guidelines</h5>
            <ul class="list-unstyled">
                <li><i class="fas fa-info-circle text-primary me-2"></i>The Excel file should have the following columns:</li>
                <li class="ms-4">• Forename (required)</li>
                <li class="ms-4">• Family Name (required)</li>
                <li class="ms-4">• Gender (Male/Female/PreferNotToSay)</li>
                <li class="ms-4">• Year of Birth (1900-2025)</li>
                <li class="mt-2"><i class="fas fa-exclamation-triangle text-warning me-2"></i>First row should contain column headers</li>
                <li><i class="fas fa-check-circle text-success me-2"></i>Duplicate records will be skipped</li>
            </ul>
        </div>
    </div>
</div>